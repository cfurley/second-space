# üë• Developer Setup Guide

## üöÄ First Time Setup (Each Developer Does This)

### 1. Clone the Repository

```bash
git clone https://github.com/cfurley/second-space.git
cd second-space
```

### 2. Start Development Environment - **That's It!** üéâ

**The simple way (works for 99% of developers):**

```bash
# Just start Docker!
docker-compose up --build

# Access your app:
# Frontend: http://localhost:80
# Backend: http://localhost:8080
# Database: localhost:5432
```

**‚úÖ No `.env` files needed!** The defaults in `docker-compose.yaml` work perfectly.

**‚úÖ No manual setup!** Docker installs everything automatically.

---

### 2b. Optional: Manual Setup (Advanced)

**Only needed if:**

- You have port conflicts (8080, 5432, 80 already in use)
- You want to run services outside Docker
- You're debugging something specific

#### Create `.env` Files (Optional)

```bash
# Backend
cd backend
cp .env.example .env
# Edit if you need custom ports/credentials

# Frontend
cd ../frontend
cp .env.example .env.local
# Usually don't need to change anything
```

#### Install Dependencies Manually (Optional)

```bash
cd backend && npm install
cd ../frontend && npm install
```

### 3. Daily Development

#### Option A: Docker Compose (Recommended)

```bash
# From project root
docker-compose up --build

# Access:
# - Frontend: http://localhost:80
# - Backend: http://localhost:8080
# - Database: localhost:5432
```

#### Option B: Run Services Separately

```bash
# Terminal 1: Start database
docker run -d \
  --name second-space-db \
  -e POSTGRES_USER=myuser \
  -e POSTGRES_PASSWORD=mypassword \
  -e POSTGRES_DB=mydatabase \
  -p 5432:5432 \
  postgres:16

# Terminal 2: Start backend
cd backend
npm start

# Terminal 3: Start frontend
cd frontend
npm run dev
# Visit http://localhost:5173
```

---

## üìù Environment Variables Explained

### Where Do Values Come From?

| File                  | Purpose                     | Committed? | Who Uses It?         |
| --------------------- | --------------------------- | ---------- | -------------------- |
| `.env.example`        | **Template** for developers | ‚úÖ YES     | Everyone (reference) |
| `.env`                | **Your local config**       | ‚ùå NO      | Only you             |
| `.env.local`          | **Local overrides**         | ‚ùå NO      | Only you             |
| `docker-compose.yaml` | **Docker defaults**         | ‚úÖ YES     | Docker users         |
| Render dashboard      | **Production secrets**      | ‚ùå NO      | Production only      |

### Priority Order (What Takes Precedence)

**Backend:**

```
1. Environment variables (set in terminal)
2. .env file (your local config)
3. Code defaults (fallback in db/index.js)
```

**Frontend:**

```
1. .env.local (your overrides)
2. .env.production (built into production build)
3. Code defaults (fallback in api.ts)
```

---

## üîÑ Common Developer Scenarios

### Scenario 1: "I want to use a different database name"

**Edit `backend/.env`:**

```bash
DB_NAME=my_custom_database
```

**Also update `docker-compose.yaml` if using Docker:**

```yaml
environment:
  - POSTGRES_DB=my_custom_database # Match your .env
```

### Scenario 2: "I'm running backend on port 3000 instead of 8080"

**Backend - Edit `backend/.env`:**

```bash
PORT=3000
```

**Frontend - Edit `frontend/.env.local`:**

```bash
VITE_API_URL=http://localhost:3000
```

### Scenario 3: "I want to test against production API"

**Edit `frontend/.env.local`:**

```bash
VITE_API_URL=https://your-app.onrender.com
```

Now your local frontend will call the production backend!

### Scenario 4: "I joined the team - what do I do?"

```bash
# 1. Clone repo
git clone <repo-url>
cd second-space

# 2. Start Docker (that's it!)
docker-compose up --build

# Done! üéâ
# No .env files needed!
# No manual npm install needed!
# Everything works out of the box!
```

---

## üîê Security Best Practices

### ‚úÖ DO:

- Copy `.env.example` to `.env` for local work
- Use strong passwords in your local `.env`
- Keep `.env` files in your local machine only
- Share the `.env.example` file (it's safe)
- Use different credentials for each environment

### ‚ùå DON'T:

- Commit `.env` files to git (they're in `.gitignore`)
- Share your `.env` file in Slack/Discord
- Use production credentials locally
- Put real passwords in `docker-compose.yaml`
- Hardcode secrets in source code

---

## üåç Different Environments

### Local Development (Your Machine)

```bash
# Uses: backend/.env
DB_HOST=database  # Docker service name
DB_USER=myuser    # Your local username
```

### Docker Compose (Team Testing)

```bash
# Uses: docker-compose.yaml environment section
# Everyone uses same defaults for consistency
DB_HOST=database
DB_USER=myuser
```

### Render.com Production

```bash
# Set in Render dashboard
# Auto-generated by render.yaml
DATABASE_URL=postgresql://user:pass@host:5432/db
# No .env file needed - Render provides env vars
```

### GitHub Actions CI/CD

```bash
# Set in .github/workflows/test.yml
# Temporary test database
DB_HOST=localhost
DB_USER=testuser
DB_PASSWORD=testpass
```

---

## üêõ Troubleshooting Environment Issues

### Problem: "Can't connect to database"

```bash
# Check your .env values match docker-compose.yaml
cat backend/.env
cat docker-compose.yaml

# Make sure database container is running
docker ps | grep postgres
```

### Problem: "CORS errors in browser"

```bash
# Check ALLOWED_ORIGINS in backend/.env includes your frontend URL
cat backend/.env | grep ALLOWED_ORIGINS

# Should include: http://localhost:5173 (Vite) or http://localhost:80 (Docker)
```

### Problem: "Frontend can't reach backend"

```bash
# Check API URL
cat frontend/.env.local

# Should be: http://localhost:8080 (or your custom port)
```

### Problem: "Changes to .env not working"

```bash
# Restart your services after changing .env:

# For Docker:
docker-compose restart backend

# For npm:
# Stop backend (Ctrl+C) and restart:
npm start
```

---

## üìã Developer Checklist

Before starting work:

- [ ] `.env` files created from examples
- [ ] Dependencies installed (`npm install`)
- [ ] Docker is running (if using Docker)
- [ ] Can access frontend (http://localhost:80 or :5173)
- [ ] Can access backend (http://localhost:8080)
- [ ] Database is initialized (tables exist)

Before committing:

- [ ] No `.env` files in `git status`
- [ ] No secrets in source code
- [ ] Tests pass locally
- [ ] `docker-compose.yaml` still has defaults

---

## üéì Quick Reference

### View Your Environment

```bash
# Backend
cd backend && cat .env

# Frontend
cd frontend && cat .env.local

# Docker
cat docker-compose.yaml
```

### Reset to Defaults

```bash
# Backend
cd backend
rm .env
cp .env.example .env

# Frontend
cd frontend
rm .env.local
cp .env.example .env.local
```

### Check What's Committed (Safety Check)

```bash
git status
# Should NOT see .env or .env.local files!

# If you accidentally added them:
git reset HEAD .env
git reset HEAD .env.local
```

---

## üí° Pro Tips

1. **Keep `.env.example` updated**: When you add new environment variables, update the example file too!

2. **Use defaults that work**: The defaults in `.env.example` should work out of the box for new developers.

3. **Document required variables**: Add comments in `.env.example` explaining what each variable does.

4. **Test with Docker first**: Before running services separately, test that Docker Compose works with defaults.

5. **Share the DEPLOYMENT.md**: Don't share `.env` files, share the documentation!

---

## ‚úÖ Summary

### **For 99% of Developers (Recommended):**

```bash
# Clone and start - that's it!
git clone <repo>
cd second-space
docker-compose up --build

# No .env files needed! üéâ
# No manual npm install needed! üéâ
# Everything works immediately! üéâ
```

### **Advanced Users Only:**

**Only create `.env` files if:**

- ‚ùå You have conflicts with default ports (8080, 5432, 80)
- ‚ùå You want different database names for testing
- ‚ùå You're running services outside Docker
- ‚ùå You're debugging specific configurations

**For normal development:** Just use Docker! The defaults work perfectly.

### **Security Reminder:**

**If you DO create `.env` files, never commit:**

- `.env`
- `.env.local`
- `.env.production` (if it has real secrets)

**They're already in `.gitignore` so you're protected!** ‚úÖ

---

**Questions? Check DEPLOYMENT.md or REMINDERS.md!**
